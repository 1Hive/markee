type Markee @entity(immutable: false) {
  id: ID!
  address: Bytes!
  owner: Bytes!
  message: String!
  name: String!
  totalFundsAdded: BigInt!
  pricingStrategy: Bytes!
  createdAt: BigInt!
  createdAtBlock: BigInt!
  updatedAt: BigInt!
  updatedAtBlock: BigInt!
  fundsAddedCount: BigInt!
  messageUpdateCount: BigInt!
  nameUpdateCount: BigInt!
  strategy: TopDawgStrategy  # Link to strategy
  fundsAddedEvents: [FundsAdded!]! @derivedFrom(field: "markee")
  messageUpdates: [MessageUpdate!]! @derivedFrom(field: "markee")
  nameUpdates: [NameUpdate!]! @derivedFrom(field: "markee")
}

type FundsAdded @entity(immutable: true) {
  id: ID!
  markee: Markee!
  addedBy: Bytes!
  amount: BigInt!
  newMarkeeTotal: BigInt!
  timestamp: BigInt!
  blockNumber: BigInt!
  transactionHash: Bytes!
}

type MessageUpdate @entity(immutable: true) {
  id: ID!
  markee: Markee!
  updatedBy: Bytes!
  oldMessage: String!
  newMessage: String!
  timestamp: BigInt!
  blockNumber: BigInt!
  transactionHash: Bytes!
}

type NameUpdate @entity(immutable: true) {
  id: ID!
  markee: Markee!
  updatedBy: Bytes!
  oldName: String!
  newName: String!
  timestamp: BigInt!
  blockNumber: BigInt!
  transactionHash: Bytes!
}

type TopDawgStrategy @entity(immutable: false) {
  id: ID!
  address: Bytes!
  minimumPrice: BigInt!
  maxMessageLength: BigInt!
  maxNameLength: BigInt!
  totalMarkeesCreated: BigInt!
  totalFundsRaised: BigInt!
  markees: [Markee!]! @derivedFrom(field: "strategy")
  createdAt: BigInt!
  createdAtBlock: BigInt!
}

type FixedPriceStrategy @entity(immutable: false) {
  id: ID!
  address: Bytes!
  markeeAddress: Bytes!
  price: BigInt!
  maxMessageLength: BigInt!
  maxNameLength: BigInt!
  revNetTerminal: Bytes!
  revNetProjectId: BigInt!
  owner: Bytes!
  currentMessage: String!
  currentName: String!
  totalRevenue: BigInt!
  messageChangeCount: BigInt!
  messageChanges: [FixedPriceMessageChange!]! @derivedFrom(field: "strategy")
  createdAt: BigInt!
  createdAtBlock: BigInt!
}

type FixedPriceMessageChange @entity(immutable: true) {
  id: ID!
  strategy: FixedPriceStrategy!
  changedBy: Bytes!
  oldMessage: String!
  newMessage: String!
  oldName: String!
  newName: String!
  pricePaid: BigInt!
  timestamp: BigInt!
  blockNumber: BigInt!
  transactionHash: Bytes!
}

type GlobalStats @entity(immutable: false) {
  id: ID!
  totalMarkees: BigInt!
  totalFundsRaised: BigInt!
  totalTransactions: BigInt!
  totalFixedPriceRevenue: BigInt!
  totalFixedPriceChanges: BigInt!
}
